\documentclass[11pt]{article}
\usepackage{palatino}

\begin{document}

\title{Extended Abstract Machine for Prettyprinting Intermediate Computations}
\maketitle

\section{Compilation Scheme}

C(i) = INT(i)\\
C(b) = BOOL(b)\\
C(a op b) = C(a); C(b); OP(o)\\
C(a = b) = C(a); C(b); EQ
C(\underline{n}) = ACCESS(n)\\
C($\lambda a$) = CLOSURE(C(a); RETURN)\\
C(let $a$ in $b$) = C($a$); LET; C($b$); ENDLET\\
C(a b) = C(a); C(b); APPLY\\
C(if a then b else c) = C($\lambda b$); C($\lambda c$); C(a); BRANCH


\section{For arithmetic only}
\begin{tabular}{l|l|l|l||l|l|l|l}
\multicolumn{4}{c}{Machine state before}&
\multicolumn{4}{c}{Machine state after}\\
Code & Env & Stack & Print & Code & Env & Stack & Print\\
INT(i); c & e & s & p & c & e & i.s & -\\
OP(o); c & e & i.i'.s & p & c & e & o(i, i').s & p\\
\end{tabular}

\section{Add lets}

e.g \texttt{let x = 1 in let y = 2 in x + y} compiles to:



\section{Full machine}

\begin{tabular}{l|l|l|l||l|l|l|l}
\multicolumn{4}{c}{Machine state before}&
\multicolumn{4}{c}{Machine state after}\\
Code & Env & Stack & Uncompile & Code & Env & Stack & Print\\
INT(i); c & e & s & p & c & e & i.s & -\\
BOOL(b); c & e & s & u & c & e & b.s & -\\
OP(o); c & e & i.i'.s & p & c & e & o(i, i').s & p\\
ACCESS($n$); c & e & s & p & c & e & e(n).s & - \\
LET; c & e & v.s & p & c & v.e & s & -\\
ENDLET; c & v.e & s & p & c & e & s & -\\
CLOSURE(c'); c & e & s & p & c & e & c'[e].s & -\\
APPLY; c & e & v.c'[e'].s & p & c' & v.e' & c.e.s & -\\
RETURN; c & e & v.c'.e'.s & p & c' & e' & v.s & -\\
\end{tabular}

\end{document}
